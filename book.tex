% Simple template for documentation based on the journal for statistical science template
\documentclass[sts]{imsart}

\usepackage{amsthm,amsmath}
\usepackage{color}
\usepackage{geometry}
\usepackage{graphicx}
\usepackage[makeroom]{cancel}
\definecolor{gray75}{gray}{0.75}
\newgeometry{vmargin={17mm}, hmargin={14mm,14mm}} 
\RequirePackage[colorlinks,citecolor=blue,urlcolor=blue]{hyperref}

% put your definitions there:
\startlocaldefs
\endlocaldefs

\begin{document}

\begin{titlepage}

\title{Diffusing ideas}
\runtitle{Diffusing ideas}
\vspace*{0.3cm}
\hspace*{-0.5cm}
{\Large \bfseries\sffamily \color{gray75} Adventures with noise and building mathematical toys}

\vspace*{3cm}
\centering
\includegraphics[width=15cm]{images/frontmatter_mashup.png}

\vspace*{4cm}
\author{Robert J. Hardwick}
\affiliation{\href{mailto:umbralcalc@gmail.com}{umbralcalc@gmail.com}}

\runauthor{Robert J. Hardwick}

\end{titlepage}

\newpage

\section*{Introduction}


\newpage
{\color{gray75} {\Huge \bfseries\sffamily 1} \hspace*{0.2em} \rule[-0.5ex]{0.3ex}{2.0em}} \hspace*{0.2em} {\Huge \bfseries\sffamily Building the `stochadex'}

\vspace*{1cm}
{\bfseries\sffamily Concept.} The idea here is 

\vspace*{1cm}
\section*{Core mathematical formalism}

Ideally, the stochadex sampler should be designed to try and maintain a balance between performance and flexibility of utilisation (it's meant to be a general stochastic modelling tool after all!). But before we dive into the software, we need to define the mathematical approach we're going to take. It seems reasonable to start with writing down the following formula which describes iterating some arbitrary process forward in time (by one finite step) and adding a new row each to some matrices $S' \rightarrow S$ and $X' \rightarrow X$
%%
\begin{align}
& X^i_{t+\delta t} = F^i_{t+\delta t}(X',t) + S^i_{t+\delta t}(X',S',t)\,,
\end{align}
%%
where to explain things in a bit more detail, let's define

\begin{itemize}
\item[]{$\delta t$ as the size of the next timestep}
\item[]{$i$ as an index for the dimensions of the 'state' space}
\item[]{$t$ as the current time which may either correspond to the index for some arbitrary stepping process (where $\delta t = 1$), or the explicit time variable for a discrete-time process or some discrete approximation to a continuous-time process}
\item[]{$X$ as the next version of $X'$ after one timestep (and hence one new row has been added)}
\item[]{$S$ as the next version of $S'$ (similarly to $X$ and $X'$)}
\item[]{$F^i_{t+\delta t}(X', t)$ as the latest element of some matrix which very generally can depend on $X'$, $t$ and $\delta t$}
\item[]{$S^i_{t+\delta t}(X', S', t)$ as the recorded values of a stochastic process defined over the dimensions of the state space indexed by $i$ which may either vary with continuous sample paths in time or not, and which very generally can depend on $X'$, $S'$, $t$ and $\delta t$.}
\end{itemize}

So the idea here is to iterate the matrices $X$ and $S$ forward in time by a row, and use their previous versions ($X'$ and $S'$) as entire matrix inputs into functions which populate the elements of their latest rows. Note that I've avoided using the time variable $t$ and its step size $\delta t$ (reducing the formalism to that of an arbitrary stepping process) to try and make the diagram above more clear, but, more generally, these values may be present in the calculations of new matrix rows.

Why go to all this trouble of storing matrix inputs for previous values of the same process? For a large class of stochastic processes this memory of past values is essential to consistently construct the sample paths moving forward. This is true in particular for \emph{non-Markovian} phenomena (see, e.g., \href{https://en.wikipedia.org/wiki/Markov_chain}{Markov chains} to get a sense of their antithesis), where the latest values don't just depend on the immediately previous ones but can depend on values which occured much earlier in the process.

\section*{Flavours of noise with continuous sample paths}

For \emph{Wiener process noise}, adopting the \href{https://en.wikipedia.org/wiki/It\%C3\%B4_calculus}{Itô interpretation} in this section, we can define $W^i_{t}$ is a sample from a Wiener process for each of the state dimensions indexed by $i$ and our formalism becomes
%%
\begin{align}
& X^i_{t+\delta t} = F^i_{t+\delta t}(X', t) + \textcolor{red}{W^i_{t+\delta t}-W^i_{t}}\,.
\end{align}
%%

Other interpretations of the noise are less immediately compatible with our formalism as it is currently written, e.g., \href{https://en.wikipedia.org/wiki/Stratonovich_integral}{Stratonovich} or others within the $\alpha$-family, but it seems less necessary to complicate the details of this section further, so we'll just cover these extensions at the software implementation level. Note also that we may also allow for correlations between the noises in different dimensions. 

For \emph{Geometric Brownian motion noise}, we simply have
%%
\begin{align}
& X^i_{t+\delta t} = F^i_{t+\delta t}(X', t) + \textcolor{red}{X^i_{t}(W^i_{t+\delta t}-W^i_{t})}\,.
\end{align}
%%

And say, e.g., \emph{fractional Brownian motion noise}, where $B^i_{t}({H_i})$ is a sample from a fractional Brownian motion process with Hurst exponent $H_i$ for each of the state dimensions indexed by $i$, we simply substitute again
%%
\begin{align}
& X^i_{t+\delta t} = F^i_{t+\delta t}(X', t) + \textcolor{red}{B^i_{t+\delta t}({H_i})-B^i_{t}({H_i})}\,.
\end{align}
%%

\emph{Generalised continuous noises} would take the form
%%
\begin{align}
& X^i_{t+\delta t} = F^i_{t+\delta t}(X', t) + \textcolor{red}{g^i_{t+\delta t}(X', W^i_{t+\delta t}-W^i_t, \dots)}\,,
\end{align}
%%
where $g^i_{t+\delta t}(X', W^i_{t+\delta t}-W^i_t, \dots)$ is some continuous function of its arguments which can be expanded out with \href{https://en.wikipedia.org/wiki/It\%C3\%B4\%27s_lemma}{Itôs Lemma}.


\section*{Flavours of noise with discontinuous sample paths}

\emph{Jump process noises} generally could take the form
%%
\begin{align}
& X^i_{t+\delta t} = F^i_{t+\delta t}(X', t) + \textcolor{red}{J^i_{t+\delta t}(X', \dots )}\,,
\end{align}
%%
where $J^i_{t+\delta t}(X', \dots )$ are samples from some arbitrary jump process (e.g., compound Poisson) which could generally depend on a variety of inputs, including $X'$. 

\emph{Poisson process noises} would generally take the form
%%
\begin{align}
& X^i_{t+\delta t} = F^i_{t+\delta t}(X', t) + \textcolor{red}{N^i_{t+\delta t}({\lambda_i})-N^i_{t}({\lambda_i})}\,,
\end{align}
%%
where $N^i_{t}({\lambda_i})$ is a sample from a Poisson process with rate $\lambda_i$ for each of the state dimensions indexed by $i$. Note that we may also allow for correlations between the noises in different dimensions.

\emph{Time-inhomogeneous Poisson process noises} would generally take the form
%%
\begin{align}
& X^i_{t+\delta t} = F^i_{t+\delta t}(X', t) + \textcolor{red}{N^i_{t+\delta t}({\lambda^i_{t+\delta t}})-N^i_{t}({\lambda^i_t})}\,,
\end{align}
%%
where $\lambda^i_{t}$ is a deterministically-varying rate for each of the state dimensions indexed by $i$.

\emph{Cox (doubly-stochastic) process noises} would generally take the form
%%
\begin{align}
& X^i_{t+\delta t} = F^i_{t+\delta t}(X', t) + \textcolor{red}{N^i_{t+\delta t}({\Lambda^i_{t+\delta t}})-N^i_{t}({\Lambda^i_{t}})}\,,
\end{align}
%%
where the rate $\Lambda^i_{t}$ is now a sample from some continuous-time stochastic process (in the positive-only domain) for each of the state dimensions indexed by $i$.

\emph{Self-exciting process noises} would generally take the form
%%
\begin{align}
& X^i_{t+\delta t} = F^i_{t+\delta t}(X', t) + \textcolor{red}{N^i_{t+\delta t}[{\cal I}^i_{t+\delta t}(N', \dots)]-N^i_{t}[{\cal I}^i_{t}(N'', \dots)]}\,,
\end{align}
%%
where the stochastic rate ${\cal I}^i_{t}(N', \dots)$ now depends on the history of $N'$ explicitly (amongst other potential inputs - see, e.g., \href{https://en.wikipedia.org/wiki/Hawkes_process}{Hawkes processes}) for each of the state dimensions indexed by $i$.

\emph{Generalised probabilistic discrete state transitions} would take the form
%%
\begin{align}
& X^i_{t+\delta t} = \slash{F^i_{t+\delta t}(X', t)} + \textcolor{red}{T^i_{t+\delta t}(X')}\,,
\end{align}
%%
where $T^i_{t+\delta t}(X')$ is a generator of the next state to occupy. This generator uses the current state transition probabilities (which are generally conditional on $X'$) at each new step.

\section*{Summary of desirable features}

\begin{itemize}
\item{using the learnings from the previous sections looking at specific example processes}
\item{above formalism is so general that it can do anything - so while it shall serve as a useful guide and reference point, it would be good here to go through more of the specific desirable components we want to have access to in the software itself}
\item{it might not always be convenient to have the windowed histories stored as S but some other varying quantity which can be used to construct S? take fractional brownian motion as an example of this! hence, need to provide more possible input histories into S}
\item{want the timestep to have either exponentially-sampled lengths or fixed lengths in time}
\item{formalism already isn't explicit about the choice of deterministic integrator in time}
\item{but also want to be able to choose the stochastic integrator in continuous processes (Itô or Stratonovich?)}
\item{enable correlated noise terms at the sample generator level}
\item{configurable setup of simulations with just yamls + a single .go file defining the terms}
\end{itemize}


Test cite~\cite{Dimastrogiovanni:2018xnn}

\section*{Design choices for the stochadex}


\bibliographystyle{JHEP}
\bibliography{book}

\end{document}
